The contract you provided may have the following potential vulnerabilities:
1) Inconsistent state update.
2) Incorrect visibility/ownership.