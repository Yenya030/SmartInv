The contract contains the following potential vulnerabilities:

1) inconsistent state update

3) business logic flaw

7) ID uniqueness violation

8) reentrancy

12) ether leakage