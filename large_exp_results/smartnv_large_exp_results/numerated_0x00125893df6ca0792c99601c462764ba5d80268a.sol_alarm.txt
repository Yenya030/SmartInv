This contract contains potential vulnerabilities: 

1) price manipulation
2) inconsistent state update
3) atomicity violation
4) arithmetic flaw