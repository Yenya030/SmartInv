The contract you provided contains potential vulnerabilities: 
1) atomicity violation
2) inconsistent state update