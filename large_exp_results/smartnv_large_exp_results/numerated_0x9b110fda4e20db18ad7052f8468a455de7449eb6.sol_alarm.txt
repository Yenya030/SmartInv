The potential vulnerabilities in the provided contract are as follows:
1) inconsistent state update
2) privilege escalation