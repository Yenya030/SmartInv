The potential vulnerabilities in the contract are:

1) inconsistency of the state update
2) the incorrect visibility/ownership of functions.