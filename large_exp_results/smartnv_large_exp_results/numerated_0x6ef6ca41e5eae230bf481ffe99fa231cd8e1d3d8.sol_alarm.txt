The contract you provided contains potential vulnerabilities: 

1) business logic flaw
2) inconsistent state update 
3) incorrect visibility/ownership