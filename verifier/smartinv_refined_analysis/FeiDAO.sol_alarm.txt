Potential vulnerabilities in the contract provided:
2) Price manipulation
3) Business logic flaw
4) Inconsistent state update