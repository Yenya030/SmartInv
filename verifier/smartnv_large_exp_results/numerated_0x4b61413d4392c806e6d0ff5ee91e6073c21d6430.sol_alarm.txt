This contract is vulnerable to the following potential vulnerabilities: 

1) price manipulation
3) business logic flaw
8) reentrancy