The potential vulnerabilities in the contract are:
- Inconsistent state update
- Insufficient gas
- Incorrect visibility/ownership