The contract contains potential vulnerabilities in the form of 1) inconsistent state update and 2) incorrect visibility/ownership.