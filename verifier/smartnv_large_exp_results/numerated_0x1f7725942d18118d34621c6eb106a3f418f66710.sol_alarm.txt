The contract contains the following potential vulnerabilities:
2) price manipulation
4) inconsistent state update
12) ether leakage