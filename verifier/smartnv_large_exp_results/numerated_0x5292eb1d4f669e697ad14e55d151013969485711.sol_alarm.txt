Contract analysis:
The contract includes potential vulnerabilities: 4) inconsistent state update; 14) incorrect visibility/ownership.