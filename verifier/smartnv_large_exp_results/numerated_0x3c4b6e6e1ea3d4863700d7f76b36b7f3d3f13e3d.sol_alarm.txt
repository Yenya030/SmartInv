potential vulnerabilities in the contract:

1) insufficient gas
2) inconsistent state update