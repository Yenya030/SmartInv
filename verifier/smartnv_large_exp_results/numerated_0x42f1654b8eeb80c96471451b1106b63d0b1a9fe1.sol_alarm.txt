The contract you provided contains potential vulnerabilities: 

1) price manipulation
2) inconsistent state update