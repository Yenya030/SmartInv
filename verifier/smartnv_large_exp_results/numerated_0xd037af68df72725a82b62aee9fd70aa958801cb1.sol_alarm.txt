The contract contains potential vulnerabilities: 

1) inconsistency state update. 
2) incorrect visibility/ownership.