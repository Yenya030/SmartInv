1 // ....................................................................................................
2 // ....................................................................................................
3 // ....................................................................................................
4 // ..............,;;;;;;;;;:,.....:;;;;;,.,;;;;;,.:;;;;;;:....,;;;;;;,.,;;;;;;;;;:,....................
5 // ..............:@@@@@@@@@@@S+...%@@@@@+.:@@@@@:.?@@@@@@S....%@@@@@@;.+@@@@@@@@@@@%;..................
6 // ..............:@@@@@@@@@@@@@?..%@@@@@+.:@@@@@:.?@@@@@@@:..:@@@@@@@;.+@@@@@@@@@@@@@;.................
7 // ..............:@@@@@#**#@@@@@:.%@@@@@+.:@@@@@:.?@@@@@@@%..?@@@@@@@;.+@@@@@S+?@@@@@%.................
8 // ..............:@@@@@S..?@@@@@+.%@@@@@+.:@@@@@:.?@@@@@@@@,,@@@@@@@@;.+@@@@@%.,@@@@@%.................
9 // ..............:@@@@@S..?@@@@@+.%@@@@@+.:@@@@@:.?@@@@@@@@**@@@@@@@@;.+@@@@@@#@@@@@S:.................
10 // ..............:@@@@@S..?@@@@@+.%@@@@@+.:@@@@@:.?@@@@@@@@##@@@@@@@@;.+@@@@@@@@@@@%:..................
11 // ..............:@@@@@S..?@@@@@+.%@@@@@+.:@@@@@:.?@@@@#@@@@@@@@@@@@@;.+@@@@@@S#@@@@@+.................
12 // ..............:@@@@@S..?@@@@@+.%@@@@@+.,@@@@@:.?@@@@%S@@@@@@?#@@@@;.+@@@@@%..#@@@@@,................
13 // ..............:@@@@@#;+#@@@@@;.*@@@@@%:*@@@@@,.?@@@@?;@@@@@@:#@@@@;.+@@@@@S;+@@@@@@:................
14 // ..............:@@@@@@@@@@@@@S,.:#@@@@@@@@@@@?..?@@@@%.#@@@@%.#@@@@;.+@@@@@@@@@@@@@%.................
15 // ..............:@@@@@@@@@@@#?,...:%@@@@@@@@@?,..?@@@@%.*@@@@;.@@@@@;.+@@@@@@@@@@@#?,.................
16 // ..............,+++++++++;:,.......:+*???*;,....;++++;.,++++..+++++,.:++++++++++:,...................
17 // ....................................................................................................
18 // ....................................................................................................
19 // .........................................,;++++++++;:,..............................................
20 // .......................................,+*;,,,,,,,:;+*+:............................................
21 // .....................................:+*:.............:+*,..........................................
22 // ...................................;*+,.................:*;.........................................
23 // ..................................:*,....................,++,.......................................
24 // .................................,*,.......................:*:......................................
25 // .................................*:.........................,*:.....................................
26 // .................................*...........................,*,....................................
27 // ................................;+............................:+....................................
28 // ................................*,...........,,::::::,.........*,...................................
29 // ...............................,+...........,;::,,,,:;;;;;;;:..;;...................................
30 // ...............................:+..............,,:;;:,......:,.,*...................................
31 // ...............................+:.........,:::;;:,,,,:;;;;;;,..,*...................................
32 // ...............................*,.........:::,.............,....+:..................................
33 // ...............................*.............::;;;;,.....,;;;:,.,*..................................
34 // ..............................,*............::,....,.....,,..,;,.*,.................................
35 // ..............................,+...................,;....,:......+:.................................
36 // ..............................,+..............,,,...,....,:......;;.................................
37 // ..............................,*.............;+%#?:........,,::..;;.................................
38 // ...............................*,............*:%@@%;......:*?@@:.+,.................................
39 // ...............................;;............,*%SS?;......;*?@@:.*,.................................
40 // ...............................,*..........................,:+*,.;+.,:::............................
41 // ................................+:.......................;........?++;+++,..........................
42 // ..........................:;;;;;**;:.....,;..............*,.......*+;+;*;+..........................
43 // .........................:+,...,,,,;,....:+..............;+.......*;,..,**,.........................
44 // ........................,*,.:;+++++?;....:;...............:.......*,....:%,.........................
45 // ........................:;.++;:,...,+....,*....,,,,.......,;++*;.,*.....,S,.........................
46 // ........................+,;+........+,....+,.,*+++++;,....,;?#+:.+:.....+*,.........................
47 // ........................+:+.........;,....+:.:+.;;;;;+,+,.,%@@;.:*.....,++,.........................
48 // .......................,++:.........;,....,*,,;,@@@@#,.:+.%SS;..*:.....;;+..........................
49 // .......................,+;:.........;:.....;;..,*S#S%+..+::,...,+.....,*:+..........................
50 // .......................,+;:.........*,.....,*........,..:;.....:+.....+:;:..........................
51 // .......................,*:+........:+.......+:..........:+.....:;...,+;,*...........................
52 // ........................+,+;.......+:.......,*,.........,+.....:?+++*:,*,...........................
53 // ........................:+.++,.....*,........;+.........,+.....:%+;;:+*,............................
54 // .........................;+.:*+;,.,+..........*,.........*.....:+;;;;:..............................
55 // ..........................:*:.,;****..........;;.........+,....:;...................................
56 // ...........................,+*+++**+..........:;.........;;....:;...................................
57 // ..................................:;..........;;.........,*,...:;...................................
58 // ..................................:;..........*:..........:*,..,*...................................
59 // ..................................:;..........+,...........:*:..;;..................................
60 // ..................................:;..........+,............,*:.,*:.................................
61 // ..................................:;..........+,.............,*,.,*:................................
62 // ..................................:;..........*,..............;:..,*;...............................
63 // ..................................:;.........,+...............,+....*:..............................
64 // ..................................;;.........:;................*....,*,.............................
65 // ..................................;;.........*,................+,....;;.............................
66 // ..................................;;........:+.................;:....,+.............................
67 // ..................................;;........*,.................;:.....+.............................
68 // ..................................:;.......;;..................+,.....+.............................
69 // ..................................;;......:*...................:,.,:;*?,............................
70 // ..................................;;.....:*,.......:;++++++++++++++;::?+............................
71 // ..................................:;....,*,.......+;::::::;;;;;+++++++;*,...........................
72 // ..................................:;....;;.......,?+++++;;;;;::;+***+++?:...........................
73 // ..................................:;....;:.......:?:,..,,::;++++;:,,,,;;............................
74 // ..................................:+....;:.......,++++*++;;::,,.......:;............................
75 // ..................................,*,...;:.........,,,................+:............................
76 // ...................................:+...:;..........................,*:.............................
77 // ....................................+:..,*........................,+*,..............................
78 // ....................................,*,..;+....................,:+?;................................
79 // .....................................:+...;*,..........,:;;;;+++++*,................................
80 // ......................................+:...:*+:,..,,;+*+;;:::,,;++,.................................
81 // ......................................,*:....:+++*++;:,......;*;,...................................
82 // .......................................,*;.................:*;,.....................................
83 // .........................................++:,............,;*,.......................................
84 // ..........................................,;*+++;;;;;;;++*;.........................................
85 // .............................................,,::::::::,,...........................................
86 // ....................................................................................................
87 // ........::::,.,:::.,::::,..,:;;;,........,::::...,::::,...,::::::,....::::::::,...:;;;:.............
88 // ........%@@@%.%@@@,;@@@@:.*#@@@@@%:......+@@@#,..*@@@@?...+@@@@@@@S*..#@@@@@@@*.:%@@@@@S:...........
89 // ........+@@@#,S@@@:+@@@S.*@@@@@@@@#,.....+@@@#,..S@@@@#,..+@@@@@@@@@+.#@@@@@@@*,#@@@@@@@#,..........
90 // ........:@@@@:@@@@+?@@@?.#@@@*;@@@@;.....+@@@#,.,@@@@@@:..+@@@#;%@@@S.#@@@%***::@@@@;+@@@,..........
91 // .........#@@@*@@@@%S@@@;,@@@@;.#@@@*.....+@@@#,.+@@@@@@*..+@@@#.+@@@S.#@@@?;;;.,@@@@S**++,..........
92 // .........?@@@S@@@@##@@#,,@@@@;.#@@@*.....+@@@#,.?@@?@@@S..+@@@#+S@@@%.#@@@@@@#..*@@@@@#+............
93 // .........+@@@@@@@@@@@@%.,@@@@;.#@@@*.,...+@@@#,,#@@;S@@@,.+@@@@@@@@@:.#@@@@@@#...;S@@@@@%,..........
94 // .........,@@@@@S%@@@@@*.,@@@@;.#@@@++##S.+@@@#,:@@@;S@@@+.+@@@@###%:.,#@@@?;;:.,+;++S@@@@;..........
95 // ..........S@@@@?+@@@@@:.,@@@@+:@@@@;*@@@,*@@@#.*@@@@@@@@%.+@@@#,,,...,#@@@?;;+:;@@@;:@@@@;..........
96 // ..........*@@@@+:@@@@#,..?@@@@@@@@#,;@@@@@@@@?.S@@@@@@@@#.+@@@#......,#@@@@@@@*,@@@@#@@@@:..........
97 // ..........;@@@@:.#@@@?...,%@@@@@@S;..*@@@@@@%,,@@@%;;@@@@;+@@@#,.....,#@@@@@@@?.*@@@@@@#;...........
98 // ..........,;;;;,.;;;;:.....:+**+;,....:+**+:..,;;;:..;;;;,,;;;;.......;;;;;;;;:..,;**+;,............
99 // ....................................................................................................
100 // ....................................................................................................
101 
102 // SPDX-License-Identifier: MIT
103 
104 pragma solidity ^0.8.0;
105 
106 /**
107  * @dev Collection of functions related to the address type
108  */
109 library Address {
110     /**
111      * @dev Returns true if `account` is a contract.
112      *
113      * [IMPORTANT]
114      * ====
115      * It is unsafe to assume that an address for which this function returns
116      * false is an externally-owned account (EOA) and not a contract.
117      *
118      * Among others, `isContract` will return false for the following
119      * types of addresses:
120      *
121      *  - an externally-owned account
122      *  - a contract in construction
123      *  - an address where a contract will be created
124      *  - an address where a contract lived, but was destroyed
125      * ====
126      */
127     function isContract(address account) internal view returns (bool) {
128         // This method relies on extcodesize, which returns 0 for contracts in
129         // construction, since the code is only stored at the end of the
130         // constructor execution.
131 
132         uint256 size;
133         // solhint-disable-next-line no-inline-assembly
134         assembly { size := extcodesize(account) }
135         return size > 0;
136     }
137 
138     /**
139      * @dev Replacement for Solidity's `transfer`: sends `amount` wei to
140      * `recipient`, forwarding all available gas and reverting on errors.
141      *
142      * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost
143      * of certain opcodes, possibly making contracts go over the 2300 gas limit
144      * imposed by `transfer`, making them unable to receive funds via
145      * `transfer`. {sendValue} removes this limitation.
146      *
147      * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].
148      *
149      * IMPORTANT: because control is transferred to `recipient`, care must be
150      * taken to not create reentrancy vulnerabilities. Consider using
151      * {ReentrancyGuard} or the
152      * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].
153      */
154     function sendValue(address payable recipient, uint256 amount) internal {
155         require(address(this).balance >= amount, "Address: insufficient balance");
156 
157         // solhint-disable-next-line avoid-low-level-calls, avoid-call-value
158         (bool success, ) = recipient.call{ value: amount }("");
159         require(success, "Address: unable to send value, recipient may have reverted");
160     }
161 
162     /**
163      * @dev Performs a Solidity function call using a low level `call`. A
164      * plain`call` is an unsafe replacement for a function call: use this
165      * function instead.
166      *
167      * If `target` reverts with a revert reason, it is bubbled up by this
168      * function (like regular Solidity function calls).
169      *
170      * Returns the raw returned data. To convert to the expected return value,
171      * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].
172      *
173      * Requirements:
174      *
175      * - `target` must be a contract.
176      * - calling `target` with `data` must not revert.
177      *
178      * _Available since v3.1._
179      */
180     function functionCall(address target, bytes memory data) internal returns (bytes memory) {
181       return functionCall(target, data, "Address: low-level call failed");
182     }
183 
184     /**
185      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with
186      * `errorMessage` as a fallback revert reason when `target` reverts.
187      *
188      * _Available since v3.1._
189      */
190     function functionCall(address target, bytes memory data, string memory errorMessage) internal returns (bytes memory) {
191         return functionCallWithValue(target, data, 0, errorMessage);
192     }
193 
194     /**
195      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
196      * but also transferring `value` wei to `target`.
197      *
198      * Requirements:
199      *
200      * - the calling contract must have an ETH balance of at least `value`.
201      * - the called Solidity function must be `payable`.
202      *
203      * _Available since v3.1._
204      */
205     function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {
206         return functionCallWithValue(target, data, value, "Address: low-level call with value failed");
207     }
208 
209     /**
210      * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but
211      * with `errorMessage` as a fallback revert reason when `target` reverts.
212      *
213      * _Available since v3.1._
214      */
215     function functionCallWithValue(address target, bytes memory data, uint256 value, string memory errorMessage) internal returns (bytes memory) {
216         require(address(this).balance >= value, "Address: insufficient balance for call");
217         require(isContract(target), "Address: call to non-contract");
218 
219         // solhint-disable-next-line avoid-low-level-calls
220         (bool success, bytes memory returndata) = target.call{ value: value }(data);
221         return _verifyCallResult(success, returndata, errorMessage);
222     }
223 
224     /**
225      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
226      * but performing a static call.
227      *
228      * _Available since v3.3._
229      */
230     function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {
231         return functionStaticCall(target, data, "Address: low-level static call failed");
232     }
233 
234     /**
235      * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
236      * but performing a static call.
237      *
238      * _Available since v3.3._
239      */
240     function functionStaticCall(address target, bytes memory data, string memory errorMessage) internal view returns (bytes memory) {
241         require(isContract(target), "Address: static call to non-contract");
242 
243         // solhint-disable-next-line avoid-low-level-calls
244         (bool success, bytes memory returndata) = target.staticcall(data);
245         return _verifyCallResult(success, returndata, errorMessage);
246     }
247 
248     /**
249      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
250      * but performing a delegate call.
251      *
252      * _Available since v3.4._
253      */
254     function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {
255         return functionDelegateCall(target, data, "Address: low-level delegate call failed");
256     }
257 
258     /**
259      * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
260      * but performing a delegate call.
261      *
262      * _Available since v3.4._
263      */
264     function functionDelegateCall(address target, bytes memory data, string memory errorMessage) internal returns (bytes memory) {
265         require(isContract(target), "Address: delegate call to non-contract");
266 
267         // solhint-disable-next-line avoid-low-level-calls
268         (bool success, bytes memory returndata) = target.delegatecall(data);
269         return _verifyCallResult(success, returndata, errorMessage);
270     }
271 
272     function _verifyCallResult(bool success, bytes memory returndata, string memory errorMessage) private pure returns(bytes memory) {
273         if (success) {
274             return returndata;
275         } else {
276             // Look for revert reason and bubble it up if present
277             if (returndata.length > 0) {
278                 // The easiest way to bubble the revert reason is using memory via assembly
279 
280                 // solhint-disable-next-line no-inline-assembly
281                 assembly {
282                     let returndata_size := mload(returndata)
283                     revert(add(32, returndata), returndata_size)
284                 }
285             } else {
286                 revert(errorMessage);
287             }
288         }
289     }
290 }
291 
292 /*
293  * @dev Provides information about the current execution context, including the
294  * sender of the transaction and its data. While these are generally available
295  * via msg.sender and msg.data, they should not be accessed in such a direct
296  * manner, since when dealing with meta-transactions the account sending and
297  * paying for execution may not be the actual sender (as far as an application
298  * is concerned).
299  *
300  * This contract is only required for intermediate, library-like contracts.
301  */
302 abstract contract Context {
303     function _msgSender() internal view virtual returns (address) {
304         return msg.sender;
305     }
306 
307     function _msgData() internal view virtual returns (bytes calldata) {
308         this; // silence state mutability warning without generating bytecode - see https://github.com/ethereum/solidity/issues/2691
309         return msg.data;
310     }
311 }
312 
313 /**
314  * @dev String operations.
315  */
316 library Strings {
317     bytes16 private constant alphabet = "0123456789abcdef";
318 
319     /**
320      * @dev Converts a `uint256` to its ASCII `string` decimal representation.
321      */
322     function toString(uint256 value) internal pure returns (string memory) {
323         // Inspired by OraclizeAPI's implementation - MIT licence
324         // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol
325 
326         if (value == 0) {
327             return "0";
328         }
329         uint256 temp = value;
330         uint256 digits;
331         while (temp != 0) {
332             digits++;
333             temp /= 10;
334         }
335         bytes memory buffer = new bytes(digits);
336         while (value != 0) {
337             digits -= 1;
338             buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
339             value /= 10;
340         }
341         return string(buffer);
342     }
343 
344     /**
345      * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.
346      */
347     function toHexString(uint256 value) internal pure returns (string memory) {
348         if (value == 0) {
349             return "0x00";
350         }
351         uint256 temp = value;
352         uint256 length = 0;
353         while (temp != 0) {
354             length++;
355             temp >>= 8;
356         }
357         return toHexString(value, length);
358     }
359 
360     /**
361      * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.
362      */
363     function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {
364         bytes memory buffer = new bytes(2 * length + 2);
365         buffer[0] = "0";
366         buffer[1] = "x";
367         for (uint256 i = 2 * length + 1; i > 1; --i) {
368             buffer[i] = alphabet[value & 0xf];
369             value >>= 4;
370         }
371         require(value == 0, "Strings: hex length insufficient");
372         return string(buffer);
373     }
374 
375 }
376 
377 /**
378  * @dev Interface of the ERC165 standard, as defined in the
379  * https://eips.ethereum.org/EIPS/eip-165[EIP].
380  *
381  * Implementers can declare support of contract interfaces, which can then be
382  * queried by others ({ERC165Checker}).
383  *
384  * For an implementation, see {ERC165}.
385  */
386 interface IERC165 {
387     /**
388      * @dev Returns true if this contract implements the interface defined by
389      * `interfaceId`. See the corresponding
390      * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]
391      * to learn more about how these ids are created.
392      *
393      * This function call must use less than 30 000 gas.
394      */
395     function supportsInterface(bytes4 interfaceId) external view returns (bool);
396 }
397 
398 /**
399  * @dev Required interface of an ERC721 compliant contract.
400  */
401 interface IERC721 is IERC165 {
402     /**
403      * @dev Emitted when `tokenId` token is transferred from `from` to `to`.
404      */
405     event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);
406 
407     /**
408      * @dev Emitted when `owner` enables `approved` to manage the `tokenId` token.
409      */
410     event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);
411 
412     /**
413      * @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its assets.
414      */
415     event ApprovalForAll(address indexed owner, address indexed operator, bool approved);
416 
417     /**
418      * @dev Returns the number of tokens in ``owner``'s account.
419      */
420     function balanceOf(address owner) external view returns (uint256 balance);
421 
422     /**
423      * @dev Returns the owner of the `tokenId` token.
424      *
425      * Requirements:
426      *
427      * - `tokenId` must exist.
428      */
429     function ownerOf(uint256 tokenId) external view returns (address owner);
430 
431     /**
432      * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients
433      * are aware of the ERC721 protocol to prevent tokens from being forever locked.
434      *
435      * Requirements:
436      *
437      * - `from` cannot be the zero address.
438      * - `to` cannot be the zero address.
439      * - `tokenId` token must exist and be owned by `from`.
440      * - If the caller is not `from`, it must be have been allowed to move this token by either {approve} or {setApprovalForAll}.
441      * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
442      *
443      * Emits a {Transfer} event.
444      */
445     function safeTransferFrom(
446         address from,
447         address to,
448         uint256 tokenId
449     ) external;
450 
451     /**
452      * @dev Transfers `tokenId` token from `from` to `to`.
453      *
454      * WARNING: Usage of this method is discouraged, use {safeTransferFrom} whenever possible.
455      *
456      * Requirements:
457      *
458      * - `from` cannot be the zero address.
459      * - `to` cannot be the zero address.
460      * - `tokenId` token must be owned by `from`.
461      * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
462      *
463      * Emits a {Transfer} event.
464      */
465     function transferFrom(
466         address from,
467         address to,
468         uint256 tokenId
469     ) external;
470 
471     /**
472      * @dev Gives permission to `to` to transfer `tokenId` token to another account.
473      * The approval is cleared when the token is transferred.
474      *
475      * Only a single account can be approved at a time, so approving the zero address clears previous approvals.
476      *
477      * Requirements:
478      *
479      * - The caller must own the token or be an approved operator.
480      * - `tokenId` must exist.
481      *
482      * Emits an {Approval} event.
483      */
484     function approve(address to, uint256 tokenId) external;
485 
486     /**
487      * @dev Returns the account approved for `tokenId` token.
488      *
489      * Requirements:
490      *
491      * - `tokenId` must exist.
492      */
493     function getApproved(uint256 tokenId) external view returns (address operator);
494 
495     /**
496      * @dev Approve or remove `operator` as an operator for the caller.
497      * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.
498      *
499      * Requirements:
500      *
501      * - The `operator` cannot be the caller.
502      *
503      * Emits an {ApprovalForAll} event.
504      */
505     function setApprovalForAll(address operator, bool _approved) external;
506 
507     /**
508      * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.
509      *
510      * See {setApprovalForAll}
511      */
512     function isApprovedForAll(address owner, address operator) external view returns (bool);
513 
514     /**
515      * @dev Safely transfers `tokenId` token from `from` to `to`.
516      *
517      * Requirements:
518      *
519      * - `from` cannot be the zero address.
520      * - `to` cannot be the zero address.
521      * - `tokenId` token must exist and be owned by `from`.
522      * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
523      * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
524      *
525      * Emits a {Transfer} event.
526      */
527     function safeTransferFrom(
528         address from,
529         address to,
530         uint256 tokenId,
531         bytes calldata data
532     ) external;
533 }
534 
535 /**
536  * @title ERC-721 Non-Fungible Token Standard, optional metadata extension
537  * @dev See https://eips.ethereum.org/EIPS/eip-721
538  */
539 interface IERC721Metadata is IERC721 {
540     /**
541      * @dev Returns the token collection name.
542      */
543     function name() external view returns (string memory);
544 
545     /**
546      * @dev Returns the token collection symbol.
547      */
548     function symbol() external view returns (string memory);
549 
550     /**
551      * @dev Returns the Uniform Resource Identifier (URI) for `tokenId` token.
552      */
553     function tokenURI(uint256 tokenId) external view returns (string memory);
554 }
555 
556 /**
557  * @title ERC721 token receiver interface
558  * @dev Interface for any contract that wants to support safeTransfers
559  * from ERC721 asset contracts.
560  */
561 interface IERC721Receiver {
562     /**
563      * @dev Whenever an {IERC721} `tokenId` token is transferred to this contract via {IERC721-safeTransferFrom}
564      * by `operator` from `from`, this function is called.
565      *
566      * It must return its Solidity selector to confirm the token transfer.
567      * If any other value is returned or the interface is not implemented by the recipient, the transfer will be reverted.
568      *
569      * The selector can be obtained in Solidity with `IERC721.onERC721Received.selector`.
570      */
571     function onERC721Received(
572         address operator,
573         address from,
574         uint256 tokenId,
575         bytes calldata data
576     ) external returns (bytes4);
577 }
578 
579 /**
580  * @dev Implementation of the {IERC165} interface.
581  *
582  * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check
583  * for the additional interface id that will be supported. For example:
584  *
585  * ```solidity
586  * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {
587  *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);
588  * }
589  * ```
590  *
591  * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.
592  */
593 abstract contract ERC165 is IERC165 {
594     /**
595      * @dev See {IERC165-supportsInterface}.
596      */
597     function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {
598         return interfaceId == type(IERC165).interfaceId;
599     }
600 }
601 
602 /**
603  * @dev Implementation of the {IERC721Receiver} interface.
604  *
605  * Accepts all token transfers.
606  * Make sure the contract is able to use its token with {IERC721-safeTransferFrom}, {IERC721-approve} or {IERC721-setApprovalForAll}.
607  */
608 contract ERC721Holder is IERC721Receiver {
609     /**
610      * @dev See {IERC721Receiver-onERC721Received}.
611      *
612      * Always returns `IERC721Receiver.onERC721Received.selector`.
613      */
614     function onERC721Received(
615         address,
616         address,
617         uint256,
618         bytes memory
619     ) public virtual override returns (bytes4) {
620         return this.onERC721Received.selector;
621     }
622 }
623 
624 /**
625  * @dev Interface of an ERC721A compliant contract.
626  */
627 interface IERC721A is IERC721, IERC721Metadata {
628     /**
629      * The caller must own the token or be an approved operator.
630      */
631     error ApprovalCallerNotOwnerNorApproved();
632 
633     /**
634      * The token does not exist.
635      */
636     error ApprovalQueryForNonexistentToken();
637 
638     /**
639      * The caller cannot approve to their own address.
640      */
641     error ApproveToCaller();
642 
643     /**
644      * The caller cannot approve to the current owner.
645      */
646     error ApprovalToCurrentOwner();
647 
648     /**
649      * Cannot query the balance for the zero address.
650      */
651     error BalanceQueryForZeroAddress();
652 
653     /**
654      * Cannot mint to the zero address.
655      */
656     error MintToZeroAddress();
657 
658     /**
659      * The quantity of tokens minted must be more than zero.
660      */
661     error MintZeroQuantity();
662 
663     /**
664      * The token does not exist.
665      */
666     error OwnerQueryForNonexistentToken();
667 
668     /**
669      * The caller must own the token or be an approved operator.
670      */
671     error TransferCallerNotOwnerNorApproved();
672 
673     /**
674      * The token must be owned by `from`.
675      */
676     error TransferFromIncorrectOwner();
677 
678     /**
679      * Cannot safely transfer to a contract that does not implement the ERC721Receiver interface.
680      */
681     error TransferToNonERC721ReceiverImplementer();
682 
683     /**
684      * Cannot transfer to the zero address.
685      */
686     error TransferToZeroAddress();
687 
688     /**
689      * The token does not exist.
690      */
691     error URIQueryForNonexistentToken();
692 
693     // Compiler will pack this into a single 256bit word.
694     struct TokenOwnership {
695         // The address of the owner.
696         address addr;
697         // Keeps track of the start time of ownership with minimal overhead for tokenomics.
698         uint64 startTimestamp;
699         // Whether the token has been burned.
700         bool burned;
701     }
702 
703     // Compiler will pack this into a single 256bit word.
704     struct AddressData {
705         // Realistically, 2**64-1 is more than enough.
706         uint64 balance;
707         // Keeps track of mint count with minimal overhead for tokenomics.
708         uint64 numberMinted;
709         // Keeps track of burn count with minimal overhead for tokenomics.
710         uint64 numberBurned;
711         // For miscellaneous variable(s) pertaining to the address
712         // (e.g. number of whitelist mint slots used).
713         // If there are multiple variables, please pack them into a uint64.
714         uint64 aux;
715     }
716 
717     /**
718      * @dev Returns the total amount of tokens stored by the contract.
719      * 
720      * Burned tokens are calculated here, use `_totalMinted()` if you want to count just minted tokens.
721      */
722     function totalSupply() external view returns (uint256);
723 }
724 
725 // ERC721A Contracts v3.3.0
726 // Creator: Chiru Labs
727 
728 /**
729  * @dev Implementation of https://eips.ethereum.org/EIPS/eip-721[ERC721] Non-Fungible Token Standard, including
730  * the Metadata extension. Built to optimize for lower gas during batch mints.
731  *
732  * Assumes serials are sequentially minted starting at _startTokenId() (defaults to 0, e.g. 0, 1, 2, 3..).
733  *
734  * Assumes that an owner cannot have more than 2**64 - 1 (max value of uint64) of supply.
735  *
736  * Assumes that the maximum token id cannot exceed 2**256 - 1 (max value of uint256).
737  */
738 contract ERC721A is Context, ERC165, IERC721A {
739     using Address for address;
740     using Strings for uint256;
741 
742     // The tokenId of the next token to be minted.
743     uint256 internal _currentIndex;
744 
745     // The number of tokens burned.
746     uint256 internal _burnCounter;
747 
748     // Token name
749     string private _name;
750 
751     // Token symbol
752     string private _symbol;
753 
754     // Mapping from token ID to ownership details
755     // An empty struct value does not necessarily mean the token is unowned. See _ownershipOf implementation for details.
756     mapping(uint256 => TokenOwnership) internal _ownerships;
757 
758     // Mapping owner address to address data
759     mapping(address => AddressData) private _addressData;
760 
761     // Mapping from token ID to approved address
762     mapping(uint256 => address) private _tokenApprovals;
763 
764     // Mapping from owner to operator approvals
765     mapping(address => mapping(address => bool)) private _operatorApprovals;
766 
767     constructor(string memory name_, string memory symbol_) {
768         _name = name_;
769         _symbol = symbol_;
770         _currentIndex = _startTokenId();
771     }
772 
773     /**
774      * To change the starting tokenId, please override this function.
775      */
776     function _startTokenId() internal view virtual returns (uint256) {
777         return 0;
778     }
779 
780     /**
781      * @dev Burned tokens are calculated here, use _totalMinted() if you want to count just minted tokens.
782      */
783     function totalSupply() public view override returns (uint256) {
784         // Counter underflow is impossible as _burnCounter cannot be incremented
785         // more than _currentIndex - _startTokenId() times
786         unchecked {
787             return _currentIndex - _burnCounter - _startTokenId();
788         }
789     }
790 
791     /**
792      * Returns the total amount of tokens minted in the contract.
793      */
794     function _totalMinted() internal view returns (uint256) {
795         // Counter underflow is impossible as _currentIndex does not decrement,
796         // and it is initialized to _startTokenId()
797         unchecked {
798             return _currentIndex - _startTokenId();
799         }
800     }
801 
802     /**
803      * @dev See {IERC165-supportsInterface}.
804      */
805     function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {
806         return
807             interfaceId == type(IERC721).interfaceId ||
808             interfaceId == type(IERC721Metadata).interfaceId ||
809             super.supportsInterface(interfaceId);
810     }
811 
812     /**
813      * @dev See {IERC721-balanceOf}.
814      */
815     function balanceOf(address owner) public view override returns (uint256) {
816         if (owner == address(0)) revert BalanceQueryForZeroAddress();
817         return uint256(_addressData[owner].balance);
818     }
819 
820     /**
821      * Returns the number of tokens minted by `owner`.
822      */
823     function _numberMinted(address owner) internal view returns (uint256) {
824         return uint256(_addressData[owner].numberMinted);
825     }
826 
827     /**
828      * Returns the number of tokens burned by or on behalf of `owner`.
829      */
830     function _numberBurned(address owner) internal view returns (uint256) {
831         return uint256(_addressData[owner].numberBurned);
832     }
833 
834     /**
835      * Returns the auxillary data for `owner`. (e.g. number of whitelist mint slots used).
836      */
837     function _getAux(address owner) internal view returns (uint64) {
838         return _addressData[owner].aux;
839     }
840 
841     /**
842      * Sets the auxillary data for `owner`. (e.g. number of whitelist mint slots used).
843      * If there are multiple variables, please pack them into a uint64.
844      */
845     function _setAux(address owner, uint64 aux) internal {
846         _addressData[owner].aux = aux;
847     }
848 
849     /**
850      * Gas spent here starts off proportional to the maximum mint batch size.
851      * It gradually moves to O(1) as tokens get transferred around in the collection over time.
852      */
853     function _ownershipOf(uint256 tokenId) internal view returns (TokenOwnership memory) {
854         uint256 curr = tokenId;
855 
856         unchecked {
857             if (_startTokenId() <= curr && curr < _currentIndex) {
858                 TokenOwnership memory ownership = _ownerships[curr];
859                 if (!ownership.burned) {
860                     if (ownership.addr != address(0)) {
861                         return ownership;
862                     }
863                     // Invariant:
864                     // There will always be an ownership that has an address and is not burned
865                     // before an ownership that does not have an address and is not burned.
866                     // Hence, curr will not underflow.
867                     while (true) {
868                         curr--;
869                         ownership = _ownerships[curr];
870                         if (ownership.addr != address(0)) {
871                             return ownership;
872                         }
873                     }
874                 }
875             }
876         }
877         revert OwnerQueryForNonexistentToken();
878     }
879 
880     /**
881      * @dev See {IERC721-ownerOf}.
882      */
883     function ownerOf(uint256 tokenId) public view override returns (address) {
884         return _ownershipOf(tokenId).addr;
885     }
886 
887     /**
888      * @dev See {IERC721Metadata-name}.
889      */
890     function name() public view virtual override returns (string memory) {
891         return _name;
892     }
893 
894     /**
895      * @dev See {IERC721Metadata-symbol}.
896      */
897     function symbol() public view virtual override returns (string memory) {
898         return _symbol;
899     }
900 
901     /**
902      * @dev See {IERC721Metadata-tokenURI}.
903      */
904     function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {
905         if (!_exists(tokenId)) revert URIQueryForNonexistentToken();
906 
907         string memory baseURI = _baseURI();
908         return bytes(baseURI).length != 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : "";
909     }
910 
911     /**
912      * @dev Base URI for computing {tokenURI}. If set, the resulting URI for each
913      * token will be the concatenation of the `baseURI` and the `tokenId`. Empty
914      * by default, can be overriden in child contracts.
915      */
916     function _baseURI() internal view virtual returns (string memory) {
917         return "";
918     }
919 
920     /**
921      * @dev See {IERC721-approve}.
922      */
923     function approve(address to, uint256 tokenId) public override {
924         address owner = ERC721A.ownerOf(tokenId);
925         if (to == owner) revert ApprovalToCurrentOwner();
926 
927         if (_msgSender() != owner && !isApprovedForAll(owner, _msgSender())) {
928             revert ApprovalCallerNotOwnerNorApproved();
929         }
930 
931         _approve(to, tokenId, owner);
932     }
933 
934     /**
935      * @dev See {IERC721-getApproved}.
936      */
937     function getApproved(uint256 tokenId) public view override returns (address) {
938         if (!_exists(tokenId)) revert ApprovalQueryForNonexistentToken();
939 
940         return _tokenApprovals[tokenId];
941     }
942 
943     /**
944      * @dev See {IERC721-setApprovalForAll}.
945      */
946     function setApprovalForAll(address operator, bool approved) public virtual override {
947         if (operator == _msgSender()) revert ApproveToCaller();
948 
949         _operatorApprovals[_msgSender()][operator] = approved;
950         emit ApprovalForAll(_msgSender(), operator, approved);
951     }
952 
953     /**
954      * @dev See {IERC721-isApprovedForAll}.
955      */
956     function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {
957         return _operatorApprovals[owner][operator];
958     }
959 
960     /**
961      * @dev See {IERC721-transferFrom}.
962      */
963     function transferFrom(
964         address from,
965         address to,
966         uint256 tokenId
967     ) public virtual override {
968         _transfer(from, to, tokenId);
969     }
970 
971     /**
972      * @dev See {IERC721-safeTransferFrom}.
973      */
974     function safeTransferFrom(
975         address from,
976         address to,
977         uint256 tokenId
978     ) public virtual override {
979         safeTransferFrom(from, to, tokenId, "");
980     }
981 
982     /**
983      * @dev See {IERC721-safeTransferFrom}.
984      */
985     function safeTransferFrom(
986         address from,
987         address to,
988         uint256 tokenId,
989         bytes memory _data
990     ) public virtual override {
991         _transfer(from, to, tokenId);
992         if (to.isContract() && !_checkContractOnERC721Received(from, to, tokenId, _data)) {
993             revert TransferToNonERC721ReceiverImplementer();
994         }
995     }
996 
997     /**
998      * @dev Returns whether `tokenId` exists.
999      *
1000      * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.
1001      *
1002      * Tokens start existing when they are minted (`_mint`),
1003      */
1004     function _exists(uint256 tokenId) internal view returns (bool) {
1005         return _startTokenId() <= tokenId && tokenId < _currentIndex && !_ownerships[tokenId].burned;
1006     }
1007 
1008     /**
1009      * @dev Equivalent to `_safeMint(to, quantity, '')`.
1010      */
1011     function _safeMint(address to, uint256 quantity) internal {
1012         _safeMint(to, quantity, "");
1013     }
1014 
1015     /**
1016      * @dev Safely mints `quantity` tokens and transfers them to `to`.
1017      *
1018      * Requirements:
1019      *
1020      * - If `to` refers to a smart contract, it must implement
1021      *   {IERC721Receiver-onERC721Received}, which is called for each safe transfer.
1022      * - `quantity` must be greater than 0.
1023      *
1024      * Emits a {Transfer} event.
1025      */
1026     function _safeMint(
1027         address to,
1028         uint256 quantity,
1029         bytes memory _data
1030     ) internal {
1031         uint256 startTokenId = _currentIndex;
1032         if (to == address(0)) revert MintToZeroAddress();
1033         if (quantity == 0) revert MintZeroQuantity();
1034 
1035         _beforeTokenTransfers(address(0), to, startTokenId, quantity);
1036 
1037         // Overflows are incredibly unrealistic.
1038         // balance or numberMinted overflow if current value of either + quantity > 1.8e19 (2**64) - 1
1039         // updatedIndex overflows if _currentIndex + quantity > 1.2e77 (2**256) - 1
1040         unchecked {
1041             _addressData[to].balance += uint64(quantity);
1042             _addressData[to].numberMinted += uint64(quantity);
1043 
1044             _ownerships[startTokenId].addr = to;
1045             _ownerships[startTokenId].startTimestamp = uint64(block.timestamp);
1046 
1047             uint256 updatedIndex = startTokenId;
1048             uint256 end = updatedIndex + quantity;
1049 
1050             if (to.isContract()) {
1051                 do {
1052                     emit Transfer(address(0), to, updatedIndex);
1053                     if (!_checkContractOnERC721Received(address(0), to, updatedIndex++, _data)) {
1054                         revert TransferToNonERC721ReceiverImplementer();
1055                     }
1056                 } while (updatedIndex < end);
1057                 // Reentrancy protection
1058                 if (_currentIndex != startTokenId) revert();
1059             } else {
1060                 do {
1061                     emit Transfer(address(0), to, updatedIndex++);
1062                 } while (updatedIndex < end);
1063             }
1064             _currentIndex = updatedIndex;
1065         }
1066         _afterTokenTransfers(address(0), to, startTokenId, quantity);
1067     }
1068 
1069     /**
1070      * @dev Mints `quantity` tokens and transfers them to `to`.
1071      *
1072      * Requirements:
1073      *
1074      * - `to` cannot be the zero address.
1075      * - `quantity` must be greater than 0.
1076      *
1077      * Emits a {Transfer} event.
1078      */
1079     function _mint(address to, uint256 quantity) internal virtual {
1080         uint256 startTokenId = _currentIndex;
1081         if (to == address(0)) revert MintToZeroAddress();
1082         if (quantity == 0) revert MintZeroQuantity();
1083 
1084         _beforeTokenTransfers(address(0), to, startTokenId, quantity);
1085 
1086         // Overflows are incredibly unrealistic.
1087         // balance or numberMinted overflow if current value of either + quantity > 1.8e19 (2**64) - 1
1088         // updatedIndex overflows if _currentIndex + quantity > 1.2e77 (2**256) - 1
1089         unchecked {
1090             _addressData[to].balance += uint64(quantity);
1091             _addressData[to].numberMinted += uint64(quantity);
1092 
1093             _ownerships[startTokenId].addr = to;
1094             _ownerships[startTokenId].startTimestamp = uint64(block.timestamp);
1095 
1096             uint256 updatedIndex = startTokenId;
1097             uint256 end = updatedIndex + quantity;
1098 
1099             do {
1100                 emit Transfer(address(0), to, updatedIndex++);
1101             } while (updatedIndex < end);
1102 
1103             _currentIndex = updatedIndex;
1104         }
1105         _afterTokenTransfers(address(0), to, startTokenId, quantity);
1106     }
1107 
1108     /**
1109      * @dev Transfers `tokenId` from `from` to `to`.
1110      *
1111      * Requirements:
1112      *
1113      * - `to` cannot be the zero address.
1114      * - `tokenId` token must be owned by `from`.
1115      *
1116      * Emits a {Transfer} event.
1117      */
1118     function _transfer(
1119         address from,
1120         address to,
1121         uint256 tokenId
1122     ) private {
1123         TokenOwnership memory prevOwnership = _ownershipOf(tokenId);
1124 
1125         if (prevOwnership.addr != from) revert TransferFromIncorrectOwner();
1126 
1127         bool isApprovedOrOwner = (_msgSender() == from ||
1128             isApprovedForAll(from, _msgSender()) ||
1129             getApproved(tokenId) == _msgSender());
1130 
1131         if (!isApprovedOrOwner) revert TransferCallerNotOwnerNorApproved();
1132         if (to == address(0)) revert TransferToZeroAddress();
1133 
1134         _beforeTokenTransfers(from, to, tokenId, 1);
1135 
1136         // Clear approvals from the previous owner
1137         _approve(address(0), tokenId, from);
1138 
1139         // Underflow of the sender's balance is impossible because we check for
1140         // ownership above and the recipient's balance can't realistically overflow.
1141         // Counter overflow is incredibly unrealistic as tokenId would have to be 2**256.
1142         unchecked {
1143             _addressData[from].balance -= 1;
1144             _addressData[to].balance += 1;
1145 
1146             TokenOwnership storage currSlot = _ownerships[tokenId];
1147             currSlot.addr = to;
1148             currSlot.startTimestamp = uint64(block.timestamp);
1149 
1150             // If the ownership slot of tokenId+1 is not explicitly set, that means the transfer initiator owns it.
1151             // Set the slot of tokenId+1 explicitly in storage to maintain correctness for ownerOf(tokenId+1) calls.
1152             uint256 nextTokenId = tokenId + 1;
1153             TokenOwnership storage nextSlot = _ownerships[nextTokenId];
1154             if (nextSlot.addr == address(0)) {
1155                 // This will suffice for checking _exists(nextTokenId),
1156                 // as a burned slot cannot contain the zero address.
1157                 if (nextTokenId != _currentIndex) {
1158                     nextSlot.addr = from;
1159                     nextSlot.startTimestamp = prevOwnership.startTimestamp;
1160                 }
1161             }
1162         }
1163 
1164         emit Transfer(from, to, tokenId);
1165         _afterTokenTransfers(from, to, tokenId, 1);
1166     }
1167 
1168     /**
1169      * @dev Equivalent to `_burn(tokenId, false)`.
1170      */
1171     function _burn(uint256 tokenId) internal virtual {
1172         _burn(tokenId, false);
1173     }
1174 
1175     /**
1176      * @dev Destroys `tokenId`.
1177      * The approval is cleared when the token is burned.
1178      *
1179      * Requirements:
1180      *
1181      * - `tokenId` must exist.
1182      *
1183      * Emits a {Transfer} event.
1184      */
1185     function _burn(uint256 tokenId, bool approvalCheck) internal virtual {
1186         TokenOwnership memory prevOwnership = _ownershipOf(tokenId);
1187 
1188         address from = prevOwnership.addr;
1189 
1190         if (approvalCheck) {
1191             bool isApprovedOrOwner = (_msgSender() == from ||
1192                 isApprovedForAll(from, _msgSender()) ||
1193                 getApproved(tokenId) == _msgSender());
1194 
1195             if (!isApprovedOrOwner) revert TransferCallerNotOwnerNorApproved();
1196         }
1197 
1198         _beforeTokenTransfers(from, address(0), tokenId, 1);
1199 
1200         // Clear approvals from the previous owner
1201         _approve(address(0), tokenId, from);
1202 
1203         // Underflow of the sender's balance is impossible because we check for
1204         // ownership above and the recipient's balance can't realistically overflow.
1205         // Counter overflow is incredibly unrealistic as tokenId would have to be 2**256.
1206         unchecked {
1207             AddressData storage addressData = _addressData[from];
1208             addressData.balance -= 1;
1209             addressData.numberBurned += 1;
1210 
1211             // Keep track of who burned the token, and the timestamp of burning.
1212             TokenOwnership storage currSlot = _ownerships[tokenId];
1213             currSlot.addr = from;
1214             currSlot.startTimestamp = uint64(block.timestamp);
1215             currSlot.burned = true;
1216 
1217             // If the ownership slot of tokenId+1 is not explicitly set, that means the burn initiator owns it.
1218             // Set the slot of tokenId+1 explicitly in storage to maintain correctness for ownerOf(tokenId+1) calls.
1219             uint256 nextTokenId = tokenId + 1;
1220             TokenOwnership storage nextSlot = _ownerships[nextTokenId];
1221             if (nextSlot.addr == address(0)) {
1222                 // This will suffice for checking _exists(nextTokenId),
1223                 // as a burned slot cannot contain the zero address.
1224                 if (nextTokenId != _currentIndex) {
1225                     nextSlot.addr = from;
1226                     nextSlot.startTimestamp = prevOwnership.startTimestamp;
1227                 }
1228             }
1229         }
1230 
1231         emit Transfer(from, address(0), tokenId);
1232         _afterTokenTransfers(from, address(0), tokenId, 1);
1233 
1234         // Overflow not possible, as _burnCounter cannot be exceed _currentIndex times.
1235         unchecked {
1236             _burnCounter++;
1237         }
1238     }
1239 
1240     /**
1241      * @dev Approve `to` to operate on `tokenId`
1242      *
1243      * Emits a {Approval} event.
1244      */
1245     function _approve(
1246         address to,
1247         uint256 tokenId,
1248         address owner
1249     ) private {
1250         _tokenApprovals[tokenId] = to;
1251         emit Approval(owner, to, tokenId);
1252     }
1253 
1254     /**
1255      * @dev Internal function to invoke {IERC721Receiver-onERC721Received} on a target contract.
1256      *
1257      * @param from address representing the previous owner of the given token ID
1258      * @param to target address that will receive the tokens
1259      * @param tokenId uint256 ID of the token to be transferred
1260      * @param _data bytes optional data to send along with the call
1261      * @return bool whether the call correctly returned the expected magic value
1262      */
1263     function _checkContractOnERC721Received(
1264         address from,
1265         address to,
1266         uint256 tokenId,
1267         bytes memory _data
1268     ) private returns (bool) {
1269         try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, _data) returns (bytes4 retval) {
1270             return retval == IERC721Receiver(to).onERC721Received.selector;
1271         } catch (bytes memory reason) {
1272             if (reason.length == 0) {
1273                 revert TransferToNonERC721ReceiverImplementer();
1274             } else {
1275                 assembly {
1276                     revert(add(32, reason), mload(reason))
1277                 }
1278             }
1279         }
1280     }
1281 
1282     /**
1283      * @dev Hook that is called before a set of serially-ordered token ids are about to be transferred. This includes minting.
1284      * And also called before burning one token.
1285      *
1286      * startTokenId - the first token id to be transferred
1287      * quantity - the amount to be transferred
1288      *
1289      * Calling conditions:
1290      *
1291      * - When `from` and `to` are both non-zero, `from`'s `tokenId` will be
1292      * transferred to `to`.
1293      * - When `from` is zero, `tokenId` will be minted for `to`.
1294      * - When `to` is zero, `tokenId` will be burned by `from`.
1295      * - `from` and `to` are never both zero.
1296      */
1297     function _beforeTokenTransfers(
1298         address from,
1299         address to,
1300         uint256 startTokenId,
1301         uint256 quantity
1302     ) internal virtual {}
1303 
1304     /**
1305      * @dev Hook that is called after a set of serially-ordered token ids have been transferred. This includes
1306      * minting.
1307      * And also called after one token has been burned.
1308      *
1309      * startTokenId - the first token id to be transferred
1310      * quantity - the amount to be transferred
1311      *
1312      * Calling conditions:
1313      *
1314      * - When `from` and `to` are both non-zero, `from`'s `tokenId` has been
1315      * transferred to `to`.
1316      * - When `from` is zero, `tokenId` has been minted for `to`.
1317      * - When `to` is zero, `tokenId` has been burned by `from`.
1318      * - `from` and `to` are never both zero.
1319      */
1320     function _afterTokenTransfers(
1321         address from,
1322         address to,
1323         uint256 startTokenId,
1324         uint256 quantity
1325     ) internal virtual {}
1326 }
1327 
1328 /**
1329  * @dev Contract module which provides a basic access control mechanism, where
1330  * there is an account (an owner) that can be granted exclusive access to
1331  * specific functions.
1332  *
1333  * By default, the owner account will be the one that deploys the contract. This
1334  * can later be changed with {transferOwnership}.
1335  *
1336  * This module is used through inheritance. It will make available the modifier
1337  * `onlyOwner`, which can be applied to your functions to restrict their use to
1338  * the owner.
1339  */
1340 abstract contract Ownable is Context {
1341     address private _owner;
1342 
1343     event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);
1344 
1345     /**
1346      * @dev Initializes the contract setting the deployer as the initial owner.
1347      */
1348     constructor() {
1349         address msgSender = _msgSender();
1350         _owner = msgSender;
1351         emit OwnershipTransferred(address(0), msgSender);
1352     }
1353 
1354     /**
1355      * @dev Returns the address of the current owner.
1356      */
1357     function owner() public view virtual returns (address) {
1358         return _owner;
1359     }
1360 
1361     /**
1362      * @dev Throws if called by any account other than the owner.
1363      */
1364     modifier onlyOwner() {
1365         require(owner() == _msgSender(), "Ownable: caller is not the owner");
1366         _;
1367     }
1368 
1369     /**
1370      * @dev Leaves the contract without owner. It will not be possible to call
1371      * `onlyOwner` functions anymore. Can only be called by the current owner.
1372      *
1373      * NOTE: Renouncing ownership will leave the contract without an owner,
1374      * thereby removing any functionality that is only available to the owner.
1375      */
1376     function renounceOwnership() public virtual onlyOwner {
1377         emit OwnershipTransferred(_owner, address(0));
1378         _owner = address(0);
1379     }
1380 
1381     /**
1382      * @dev Transfers ownership of the contract to a new account (`newOwner`).
1383      * Can only be called by the current owner.
1384      */
1385     function transferOwnership(address newOwner) public virtual onlyOwner {
1386         require(newOwner != address(0), "Ownable: new owner is the zero address");
1387         emit OwnershipTransferred(_owner, newOwner);
1388         _owner = newOwner;
1389     }
1390 }
1391 
1392 /**
1393  * @dev These functions deal with verification of Merkle Trees proofs.
1394  *
1395  * The proofs can be generated using the JavaScript library
1396  * https://github.com/miguelmota/merkletreejs[merkletreejs].
1397  * Note: the hashing algorithm should be keccak256 and pair sorting should be enabled.
1398  *
1399  * See `test/utils/cryptography/MerkleProof.test.js` for some examples.
1400  */
1401 library MerkleProof {
1402     /**
1403      * @dev Returns true if a `leaf` can be proved to be a part of a Merkle tree
1404      * defined by `root`. For this, a `proof` must be provided, containing
1405      * sibling hashes on the branch from the leaf to the root of the tree. Each
1406      * pair of leaves and each pair of pre-images are assumed to be sorted.
1407      */
1408     function verify(
1409         bytes32[] memory proof,
1410         bytes32 root,
1411         bytes32 leaf
1412     ) internal pure returns (bool) {
1413         bytes32 computedHash = leaf;
1414 
1415         for (uint256 i = 0; i < proof.length; i++) {
1416             bytes32 proofElement = proof[i];
1417 
1418             if (computedHash <= proofElement) {
1419                 // Hash(current computed hash + current element of the proof)
1420                 computedHash = keccak256(abi.encodePacked(computedHash, proofElement));
1421             } else {
1422                 // Hash(current element of the proof + current computed hash)
1423                 computedHash = keccak256(abi.encodePacked(proofElement, computedHash));
1424             }
1425         }
1426 
1427         // Check if the computed hash (root) is equal to the provided root
1428         return computedHash == root;
1429     }
1430 }
1431 
1432 contract DumbWojapes is Ownable, ERC721A {
1433     uint256 public constant MAX_WL_JAPES_PURCHASE = 10;
1434     uint256 public constant MAX_PL_JAPES_PURCHASE = 20;
1435     uint256 public constant MAX_SUPPLY = 6969;
1436 
1437     bytes32 public freeRoot;
1438     bytes32 public presaleRoot;
1439 
1440     uint256 public JAPES_PRICE = 0.0269 ether;
1441     uint256 public presaleStartTime = type(uint256).max;
1442     uint256 public saleStartTime = type(uint256).max;
1443 
1444     bool private isDevMinted = false;
1445     bool public isSaleActive = false;
1446 
1447     mapping(address => uint256) private whitelistClaimedAmounts;
1448     mapping(address => uint256) private freeClaimedAmounts;
1449 
1450     string public baseURI;
1451 
1452     constructor(
1453         uint256 _presaleStartTime,
1454         uint256 _saleStartTime,
1455         bytes32 _presaleRoot,
1456         bytes32 _freeRoot
1457     ) ERC721A("Dumb Wojapes", "WOJAPE") {
1458         require(_saleStartTime > _presaleStartTime, "Invalid timestamp");
1459         presaleStartTime = _presaleStartTime;
1460         saleStartTime = _saleStartTime;
1461         presaleRoot = _presaleRoot;
1462         freeRoot = _freeRoot;
1463     }
1464 
1465     function setBaseURI(string memory newURI) public onlyOwner {
1466         baseURI = newURI;
1467     }
1468     
1469     function setFreeRoot(bytes32 _freeRoot) public onlyOwner {
1470         freeRoot = _freeRoot;
1471     }
1472 
1473     function setPresaleRoot(bytes32 _presaleRoot) public onlyOwner {
1474         presaleRoot = _presaleRoot;
1475     }
1476 
1477     function setJapesPrice(uint256 _japesPrice) external onlyOwner {
1478         JAPES_PRICE = _japesPrice;
1479     }
1480 
1481     function setSaleStartTime(uint256 _startTime) external onlyOwner {
1482         saleStartTime = _startTime;
1483     }
1484 
1485     function setPresaleStartTime(uint256 _startTime) external onlyOwner {
1486         presaleStartTime = _startTime;
1487     }
1488 
1489     function toggleSaleState() external onlyOwner {
1490         isSaleActive = !isSaleActive;
1491     }
1492 
1493     function devMint() external onlyOwner {
1494         require(!isDevMinted, "Already minted");
1495         isDevMinted = true;
1496         _safeMint(msg.sender, 20);
1497         _safeMint(msg.sender, 20);
1498         _safeMint(msg.sender, 20);
1499         _safeMint(msg.sender, 20);
1500         _safeMint(msg.sender, 20);
1501     }
1502 
1503     function freeMint(uint256 amountToMint, bytes32[] calldata merkleProof)
1504         external
1505     {
1506         require(isSaleActive, "Not active");
1507         require(
1508             totalSupply() + amountToMint <= MAX_SUPPLY,
1509             "Exceed Total Supply"
1510         );
1511         require(freeClaimedAmounts[msg.sender] == 0, "Already claimed");
1512         bytes32 node = keccak256(abi.encodePacked(msg.sender, amountToMint));
1513         require(
1514             MerkleProof.verify(merkleProof, freeRoot, node),
1515             "MerkleDistributor: Invalid proof"
1516         );
1517         freeClaimedAmounts[msg.sender] = amountToMint;
1518         _mint(msg.sender, amountToMint);
1519     }
1520 
1521     // DM Avery Famous#5142 for feet pics.
1522     function whitelistMint(uint256 amountToMint, bytes32[] calldata merkleProof)
1523         external
1524         payable
1525     {
1526         require(isSaleActive, "Not active");
1527         require(block.timestamp >= presaleStartTime, "Not started");
1528         require(
1529             totalSupply() + amountToMint <= MAX_SUPPLY,
1530             "Exceed Total Supply"
1531         );
1532         require(
1533             whitelistClaimedAmounts[msg.sender] + amountToMint <=
1534                 MAX_WL_JAPES_PURCHASE,
1535             "Exceed Max Whitelist Mint"
1536         );
1537         require(msg.value == JAPES_PRICE * amountToMint, "Wrong payment");
1538         bytes32 node = keccak256(abi.encodePacked(msg.sender));
1539         require(
1540             MerkleProof.verify(merkleProof, presaleRoot, node),
1541             "MerkleDistributor: Invalid proof"
1542         );
1543 
1544         whitelistClaimedAmounts[msg.sender] += amountToMint;
1545         _mint(msg.sender, amountToMint);
1546     }
1547 
1548     function mint(uint256 amountToMint) external payable {
1549         require(isSaleActive, "Not active");
1550         require(block.timestamp >= saleStartTime, "Not started");
1551         require(
1552             totalSupply() + amountToMint <= MAX_SUPPLY,
1553             "Exceed Total Supply"
1554         );
1555         uint256 minted = _numberMinted(msg.sender);
1556         uint256 wlMinted = whitelistClaimedAmounts[msg.sender];
1557         uint256 freeMinted = freeClaimedAmounts[msg.sender];
1558         require(
1559             minted + amountToMint - wlMinted - freeMinted <=
1560                 MAX_PL_JAPES_PURCHASE,
1561             "Exceed Max Public Mint"
1562         );
1563         require(msg.value == JAPES_PRICE * amountToMint, "Wrong payment");
1564 
1565         _mint(msg.sender, amountToMint);
1566     }
1567 
1568     function _baseURI() internal view virtual override returns (string memory) {
1569         return baseURI;
1570     }
1571 
1572     function _startTokenId() internal view virtual override returns (uint256) {
1573         return 1;
1574     }
1575 
1576     function withdrawETH() external onlyOwner {
1577         address payable TREASURY = payable(0xe0a4db1A7633a1a0D6AD58ca272DE4748858B10A); // 15%: 26 ETH
1578         address payable AVERY = payable(0x7fb2A4BeC4712fE718a70a7D331034B84470fD67); // 50%: 89 ETH
1579         address payable PIGGY = payable(0x893e81aa2987F9Fe7D349F229514bF21699e5Efc); // 20%: 35 ETH
1580         address payable ZAMO = payable(0xD3aCC7211d197874a9FDF42bA1999178322f568D); // 5%: 9 ETH
1581         address payable OTHER = payable(0x6E3B535ae8A6B3A10e2f5d9feB1516E76b43244c); // 10%: 18 ETH
1582 
1583         uint256 totalBalance = address(this).balance;
1584         sendValue(AVERY, percentOfTotal(totalBalance, 0.50 gwei));
1585         sendValue(PIGGY, percentOfTotal(totalBalance, 0.20 gwei));
1586         sendValue(ZAMO, percentOfTotal(totalBalance, 0.05 gwei));
1587         sendValue(OTHER, percentOfTotal(totalBalance, 0.1 gwei));
1588         sendValue(TREASURY, address(this).balance); 
1589     }
1590 
1591     function percentOfTotal(uint256 total, uint256 percentInGwei) internal pure returns (uint256) {
1592         return (total * percentInGwei) / 1 gwei;
1593     }
1594 
1595     function sendValue(address payable recipient, uint256 amount) internal {
1596         require(address(this).balance >= amount, "Address: insufficient balance");
1597 
1598         (bool success, ) = recipient.call{value: amount}("");
1599         require(success, "Address: unable to send value, recipient may have reverted");
1600     }
1601 }