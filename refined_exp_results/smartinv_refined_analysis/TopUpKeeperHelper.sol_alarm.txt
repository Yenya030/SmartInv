The contract you provided contains the potential vulnerability of inconsistent state update.